<Window x:Class="Calc.ConnectorRevit.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Calc.ConnectorRevit.Views" 
        d:DataContext="{d:DesignInstance Type=local:ViewModel}"
        Loaded="WindowLoaded"
        mc:Ignorable="d" 
        Background="White"
        Height="600" MinHeight="600"
        Width="600" MinWidth="600"
        WindowStartupLocation="CenterScreen"
        Topmost="True">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="MainViewResources.xaml"/>
                <ResourceDictionary Source="ToggleButtonResource.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="20*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="20*"/>
            </Grid.ColumnDefinitions>
            
            <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="0"/>
            <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <DockPanel Grid.Column="0"
                       Grid.Row="0"
                       Margin="10"
                       HorizontalAlignment="Stretch">
                <Button Content="Load" Style= "{StaticResource ButtonStyle}"/>
                <ComboBox x:Name="ForestsComboBox"
                            ItemsSource="{Binding DataContext.AllForests, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                          DisplayMemberPath="Name"
                          DockPanel.Dock="Left"
                          Height="25"
                          SelectionChanged="ForestSelectionChanged"
                          HorizontalAlignment="Stretch"/>
            </DockPanel>

            <DockPanel Grid.Column="2"
                       Grid.Row="0"
                       Margin="10"
                       HorizontalAlignment="Stretch">
                <Button Content="Save" Style= "{StaticResource ButtonStyle}"/>
                <Button Content="Load" Style= "{StaticResource ButtonStyle}"/>
                <ComboBox x:Name="MappingsComboBox"
                          ItemsSource="{Binding DataContext.AllMappings, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                          DisplayMemberPath="Name"
                          DockPanel.Dock="Left"
                          Height="25"
                          SelectionChanged="MappingSelectionChanged"
                          HorizontalAlignment="Stretch"/>
            </DockPanel>

            <Grid Grid.Column="0"
                  Grid.Row="2"
                  Margin="10">
                <TreeView x:Name="TreeView"
                      ItemsSource="{Binding BranchItems}"
                      TreeViewItem.Selected="TreeViewItemSelected"
                      MouseLeftButtonDown="SideClickDown"
                      ItemContainerStyle="{StaticResource TreeViewItemStyle}">
                    <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding SubBranchItems}">
                        <ContentControl Content="{Binding}"
                                        ContentTemplateSelector="{StaticResource ItemTemplateSelector}"/>
                    </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
                <StackPanel Grid.Row="1"
                            Orientation="Horizontal"
                            VerticalAlignment="Bottom"
                            HorizontalAlignment="Right"
                            Margin="0,0,10,20">
                    <TextBlock Text="Branch" FontSize="10"/>
                    <ToggleButton Style="{StaticResource ToggleButtonStyle}" Margin="4,-2,4,0"/>
                    <TextBlock Text="Buildup" FontSize="10"/>
                </StackPanel>
                
            </Grid>

            <DockPanel Grid.Column="2"
                    Grid.Row="2"
                    Margin="10">
                <Button Content="Calculate"
                    DockPanel.Dock="Bottom"
                    Height="30"
                    Click="CalculateClicked"/>
                <ContentControl DockPanel.Dock="Top"
                            ContentTemplate="{StaticResource BuildupTemplate}"
                            BorderThickness="1"/>
            </DockPanel>
        </Grid>
        
        <Grid x:Name="SelectProjectOverlay"
          Background="White"
          Margin="10">
            <StackPanel VerticalAlignment="Center">
                <TextBlock HorizontalAlignment="Center"
                            Text="CHOOSE PROJECT:"
                           Margin="10"/>
                <ComboBox x:Name="ProjectsComboBox"
                          HorizontalAlignment="Center"
                          ItemsSource= "{Binding AllProjects}"
                          DisplayMemberPath="ProjectNumber"
                          Width="90"/>
                <Button Content="OK" 
                        HorizontalAlignment="Center"
                        Width="90"
                        Margin="10"
                        Click="ProjectOKClicked"/>
            </StackPanel>
        </Grid>
        
        <Grid x:Name="LoadingOverlay"
          Background="LightGray"
          Margin="10">
            <TextBlock HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Text="LOADING..."/>
        </Grid>

    </Grid>
</Window>